apiVersion: v1
kind: Pod
metadata:
  name: spark-deployment
  namespace: default
spec:
  containers:
  - name: spark-xgboost-sgx-example
    image: xgboost-spark-sgx:1.0.0
    imagePullPolicy: Never
    volumeMounts:
    - name: sgx-enclave
      mountPath: /dev/sgx/enclave
    - name: sgx-provision
      mountPath: /dev/sgx/provision
    - name: data-exchange
      mountPath: /opt/occlum_spark/data
    - name: xgboost-data
      mountPath: /opt/occlum_spark/data
    securityContext:
      privileged: true
  env:
    - name: SGX_MEM_SIZE
      value: "10GB"
    - name: SGX_THREAD
      value: 2048
    - name: SGX_HEAP
      value: "2GB"
    - name: SGX_KERNEL_HEAP
      value: "2GB"
    - name: SGX_MMAP
      value: "6GB"
  volumes:
  - name: sgx-enclave
    hostPath:
      path: /dev/sgx_enclave
  - name: sgx-provision
    hostPath:
      path: /dev/sgx_provision
  - name: data-exchange
    hostPath:
      path: /tmp
  - name: xgboost-data
    hostPath:
      path: /your_local_xgboost_encrypted_path
